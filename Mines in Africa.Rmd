---
title: "Mines in Africa"
author: "Pony Ameri"
date: "8/5/2020"
output:
  html_document: default
  pdf_document: default
---

*Introduction*

Africa is home to an abundance of mineral deposits such as copper, gold, diamonds, and cobalt among many others. 


```{r setup, include=FALSE}
library(ggplot2)
library(kableExtra)
library(treemap)
library(readr)
library(dplyr)
library(tidyverse)

mines<-read_csv("Mines_Africa_Districts.csv")
region<-read_csv("country_region_africa.csv")

```

```{r}
data<-merge(mines,region, by="countryname")
df<-data%>%
  rename(Country=countryname)%>%
  select(-c(countrycode,ADM1,ADM2))
```

```{r}
smry_df<-df%>%
  # filter(mines !=0)%>%
  group_by(Region,Country)%>%
  summarize(Mines=sum(mines),AluminiumMines=sum(aluminum_mine),
            AsbestosMines=sum(asbestos_mine),
            BariumbariteMines=sum(bariumbarite_mine),
             BerryliumMines=sum(beryllium_mine),
            BoronboratesMines=sum( boronborates_mine),
            ChromiumMines=sum(chromium_mine),CopperMines=sum(copper_mine),
            DiamondMines=sum(diamond_mine), GoldMines=sum(gold_mine),
            IronMines=sum(iron_mine),LeadMines=sum(lead_mine),
            MaganeseMines=sum(manganese_mine),MicaMines=sum(mica_mine),
            NickelMines=sum(nickel_mine),
            PhosphorousPhosphatesMines=sum(phosphorusphosphates_mine),
            PlatinumMines=sum(platinum_mine),ReeMines=sum(ree_mine),
            SilverMines=sum(silver_mine),SulfurMines=sum(sulfur_mine),
            TungstenMines=sum(tungsten_mine),StrontiumMines=sum(strontium_mine),
            TinMines=sum(tin_mine),UraniumMines=sum(uranium_mine),
            ZincMines=sum(zinc_mine))
# write.csv(smry_df,'mines.csv',row.names=False)
```

```{r}
mine_type<-data.frame(cbind(Mineral=names(sapply(smry_df[,4:27], max)), 
                            Total=unname(sapply(smry_df[,4:27], max))))
mine_type[['Total']]<-as.numeric(mine_type[['Total']])
new_data<- function(){
  df_list<-list()
  col<-as.character(unique(mine_type[['Mineral']]))
  for (i in col){
    df1<-smry_df%>%
      select(Region,Country,i)%>%
      mutate(Mineral= unlist(strsplit(i,"Mines"))) %>%
      rename(Mines=i)%>%
      filter(Mines !=0)
    df_list[[i]]<-df1
  }
  dplyr::bind_rows(df_list)
}
minerals=new_data()
```

There are a total of 2540 mines with Southern Africa owning 48.66% of mines.

```{r}
ggplot(smry_df,aes(Mines))+
  geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)+
  labs(title='Distribution of mines across Africa')
```

```{r}
smry<-smry_df %>%
  group_by(Region)%>%
  summarise(Mines=sum(Mines))%>%
  mutate(Percentage= round(100*(Mines/sum(Mines)),2))

total<-cbind(Region='Total',Mines=sum(smry_df$Mines),Percentage=100)
  kable(rbind(smry,total),caption='Mine distribution by Region')%>%
  kable_styling(bootstrap_options = "striped",font_size=10.5, 
                position = "left")
  
ggplot(smry_df,aes(Mines, group=Region,fill=Region))+
  geom_density(position="fill")+
  labs(title='Distribution of mines across regions in Africa')
```


```{r}
treemap(minerals, #Your data frame object
        index=c("Mineral","Country"),  #A list of your categorical variables
        vSize = "Mines",  #This is your quantitative variable
        type="index", #Type sets the organization and color scheme of your treemap
        palette = "Reds",  #Select your color palette from the RColorBrewer presets or make your own.
        title="Distribution of various mines across countries in Africa", #Customize your title
        fontsize.title = 14 #Change the font size of the title
        )

```







